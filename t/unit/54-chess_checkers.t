#!perl -T
use strict;
use warnings FATAL => 'all';
use Test::More tests => 12;

use Spreadsheet::HTML;

my $generator = Spreadsheet::HTML->new( sorted_attrs => 1 );

my $html = '<table style="border: thick outset" width="65%"><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9820;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9822;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9821;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9819;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9818;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9821;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9822;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9820;</div></td></tr><tr><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td></tr><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td></tr><tr><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9814;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9816;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9815;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9813;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9812;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9815;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9816;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9814;</div></td></tr></table>';

is scrub( $generator->chess() ),
    $html,
    "chess as method correct";

is scrub( Spreadsheet::HTML::chess( sorted_attrs => 1 ) ),
    $html,
    "chess as function correct";

$html = '<table border="1"><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9820;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9822;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9821;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9819;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9818;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9821;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9822;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9820;</div></td></tr><tr><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td></tr><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td></tr><tr><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9814;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9816;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9815;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9813;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9812;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9815;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9816;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9814;</div></td></tr></table>';

is scrub( $generator->chess( table => { border => 1 } ) ),
    $html,
    "chess can override params (method)";

is scrub( Spreadsheet::HTML::chess( sorted_attrs => 1, table => { border => 1 } ) ),
    $html,
    "chess can override params (function)";


# checkers

$html = '<table id="checkers"><tr><td class="cell off">&nbsp;</td><td class="cell on" id="1">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="2">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="3">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="4">&#9814</td></tr><tr><td class="cell on" id="5">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="6">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="7">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="8">&#9814</td><td class="cell off">&nbsp;</td></tr><tr><td class="cell off">&nbsp;</td><td class="cell on" id="9">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="10">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="11">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="12">&#9814</td></tr><tr><td class="cell on" id="13">&nbsp;</td><td class="cell off">&nbsp;</td><td class="cell on" id="14">&nbsp;</td><td class="cell off">&nbsp;</td><td class="cell on" id="15">&nbsp;</td><td class="cell off">&nbsp;</td><td class="cell on" id="16">&nbsp;</td><td class="cell off">&nbsp;</td></tr><tr><td class="cell off">&nbsp;</td><td class="cell on" id="17">&nbsp;</td><td class="cell off">&nbsp;</td><td class="cell on" id="18">&nbsp;</td><td class="cell off">&nbsp;</td><td class="cell on" id="19">&nbsp;</td><td class="cell off">&nbsp;</td><td class="cell on" id="20">&nbsp;</td></tr><tr><td class="cell on" id="21">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="22">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="23">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="24">&#9814</td><td class="cell off">&nbsp;</td></tr><tr><td class="cell off">&nbsp;</td><td class="cell on" id="25">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="26">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="27">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="28">&#9814</td></tr><tr><td class="cell on" id="29">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="30">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="31">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="32">&#9814</td><td class="cell off">&nbsp;</td></tr></table>';

is scrub( $generator->checkers() ),
    $html,
    "checkers as method correct";

is scrub( Spreadsheet::HTML::checkers( sorted_attrs => 1 ) ),
    $html,
    "checkers as function correct";

is scrub( $generator->draughts() ),
    $html,
    "draughts as method correct";

is scrub( Spreadsheet::HTML::draughts( sorted_attrs => 1 ) ),
    $html,
    "draughts as function correct";

$html = '<table border="1" id="checkers"><tr><td class="cell off">&nbsp;</td><td class="cell on" id="1">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="2">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="3">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="4">&#9814</td></tr><tr><td class="cell on" id="5">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="6">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="7">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="8">&#9814</td><td class="cell off">&nbsp;</td></tr><tr><td class="cell off">&nbsp;</td><td class="cell on" id="9">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="10">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="11">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="12">&#9814</td></tr><tr><td class="cell on" id="13">&nbsp;</td><td class="cell off">&nbsp;</td><td class="cell on" id="14">&nbsp;</td><td class="cell off">&nbsp;</td><td class="cell on" id="15">&nbsp;</td><td class="cell off">&nbsp;</td><td class="cell on" id="16">&nbsp;</td><td class="cell off">&nbsp;</td></tr><tr><td class="cell off">&nbsp;</td><td class="cell on" id="17">&nbsp;</td><td class="cell off">&nbsp;</td><td class="cell on" id="18">&nbsp;</td><td class="cell off">&nbsp;</td><td class="cell on" id="19">&nbsp;</td><td class="cell off">&nbsp;</td><td class="cell on" id="20">&nbsp;</td></tr><tr><td class="cell on" id="21">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="22">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="23">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="24">&#9814</td><td class="cell off">&nbsp;</td></tr><tr><td class="cell off">&nbsp;</td><td class="cell on" id="25">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="26">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="27">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="28">&#9814</td></tr><tr><td class="cell on" id="29">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="30">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="31">&#9814</td><td class="cell off">&nbsp;</td><td class="cell on" id="32">&#9814</td><td class="cell off">&nbsp;</td></tr></table>';

is scrub( $generator->checkers( table => { border => 1 } ) ),
    $html,
    "checkers can override params (method)";

is scrub( Spreadsheet::HTML::checkers( sorted_attrs => 1, table => { border => 1 } ) ),
    $html,
    "checkers can override params (function)";

is scrub( $generator->draughts( table => { border => 1 } ) ),
    $html,
    "draughts can override params (method)";

is scrub( Spreadsheet::HTML::draughts( sorted_attrs => 1, table => { border => 1 } ) ),
    $html,
    "draughts can override params (function)";




sub scrub {
    $_[0] =~ s/.*?<table/<table/s;
    return $_[0];
}
