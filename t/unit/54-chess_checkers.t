#!perl -T
use strict;
use warnings FATAL => 'all';
use Test::More tests => 12;

use Spreadsheet::HTML;

my $generator = Spreadsheet::HTML->new( sorted_attrs => 1 );

my $html = '<table style="border: thick outset" width="65%"><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9820;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9822;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9821;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9819;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9818;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9821;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9822;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9820;</div></td></tr><tr><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td></tr><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td></tr><tr><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9814;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9816;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9815;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9813;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9812;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9815;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9816;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9814;</div></td></tr></table>';

is scrub( $generator->chess() ),
    $html,
    "chess as method correct";

is scrub( Spreadsheet::HTML::chess( sorted_attrs => 1 ) ),
    $html,
    "chess as function correct";

$html = '<table border="1"><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9820;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9822;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9821;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9819;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9818;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9821;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9822;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9820;</div></td></tr><tr><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9823;</div></td></tr><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9817;</div></td></tr><tr><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9814;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9816;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9815;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9813;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9812;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9815;</div></td><td align="center" height="65" style="background-color: #aaaaaa; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9816;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9814;</div></td></tr></table>';

is scrub( $generator->chess( table => { border => 1 } ) ),
    $html,
    "chess can override params (method)";

is scrub( Spreadsheet::HTML::chess( sorted_attrs => 1, table => { border => 1 } ) ),
    $html,
    "chess can override params (function)";

$html = '<table style="border: thick outset" width="65%"><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td></tr><tr><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td></tr><tr><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td></tr><tr><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr></table>';

is scrub( $generator->checkers() ),
    $html,
    "checkers as method correct";

is scrub( Spreadsheet::HTML::checkers( sorted_attrs => 1 ) ),
    $html,
    "checkers as function correct";

is scrub( $generator->draughts() ),
    $html,
    "draughts as method correct";

is scrub( Spreadsheet::HTML::draughts( sorted_attrs => 1 ) ),
    $html,
    "draughts as function correct";

$html = '<table border="1"><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td></tr><tr><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9922;</div></td></tr><tr><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr><tr><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td></tr><tr><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td><td align="center" height="65" style="background-color: red; border: thin inset; font-size: xx-large;" width="65"><div class="game-piece">&#9920;</div></td><td align="center" height="65" style="background-color: white; border: thin inset; font-size: xx-large;" width="65">&nbsp;</td></tr></table>';

is scrub( $generator->checkers( table => { border => 1 } ) ),
    $html,
    "checkers can override params (method)";

is scrub( Spreadsheet::HTML::checkers( sorted_attrs => 1, table => { border => 1 } ) ),
    $html,
    "checkers can override params (function)";

is scrub( $generator->draughts( table => { border => 1 } ) ),
    $html,
    "draughts can override params (method)";

is scrub( Spreadsheet::HTML::draughts( sorted_attrs => 1, table => { border => 1 } ) ),
    $html,
    "draughts can override params (function)";




sub scrub {
    $_[0] =~ s/.*?<table/<table/s;
    return $_[0];
}
